function [M_i, M_d] = Hinf(Ur, Rr, velBody)
        
    % H INFINITO (matrices A, B, C, D)
    A = [0.3166, 0.000495010414223325, -0.00333937125248452, 2.40286944609632, 0.00915814246877045, 0.117761141167872, 0.00251517798550882;
         5.40741300780403e-05, 0.951196996210378, 0.368093871737200, 0.000618441743298645, -0.900636777065195, 3.57860864560393e-05, -0.00645036014358575;
         -4.27350165734011e-05, 0.0360043397301523, 0.554595644477981, -0.000722158921562911, 0.963900814191687, -3.29814404550843e-05, 0.000929263035261145;
         9.74738130766904e-15, -2.22819156643580e-12, 1.57013040396079e-11, 0.999200319872053, -4.00955379544565e-11, 3.58299359766609e-15, -2.08325415421773e-12;
         3.11688449289474e-18, -7.99549564875759e-16, 5.63612847760353e-15, 1.65228730201321e-18, 0.999800019997986, 1.23234688015350e-18, -7.47578218180561e-16;
         -2.49257515829194, 0.0378103562793925, -0.238002452286121, 9.10513700978578, 0.635720173625357, -0.552693668407488, 0.0105269194311767;
         0.000912729050256367, -1.68639408429943, 10.4202823469188, 0.0223536447875703, -27.9518222535072, 0.000822827292531607, -0.864097527716423];  % (7x7)

    B = [0.0478248439764841, 0.000226923346973228, 0.0479812984988504, 0.000225387015743105;
         7.58036698106008e-06, -0.00715146054163218, 1.06977350092788e-05, -0.00716947335481180;
         -1.18116460804164e-05, 0.00881009242714553, -1.35363125298376e-05, 0.00881887300104030;
         0.0399840063974410, 2.73110240984954e-14, 0.0399840063974410, 2.72375971802069e-14;
         -1.06353410465807e-19, 0.0199980001999800, -2.14063440481788e-20, 0.0199980001999800;
         0.182542457319418, 0.00627813318560780, 0.182246609054090, 0.00627920252621309;
         0.000469858641990445, -0.287109621838555, 0.000454949852263351, -0.287030830780295];  % (7x4)

    C = [-190.168868235004, 2.88470846597925, -18.1581914743234, 694.668561754478, 48.5017214146264, 34.1264686476395, 0.803142223241827;
         0.0278549764551581, -51.4655, 318.009730651167, 0.682196155660706, -853.043244905504, 0.0251113239506201, 4.14599212174637];  % (2x7)

    D = [13.9269190731477, 0.478984747386228, 13.9043475853434, 0.479066331803849;
         0.0143393062883452, -8.76210936215517, 0.0138843147585955, -8.75970478976636];  % (2x4)

    % Valores iniciales
    X = [0; 0; 0; 0; 0; 0; 0];  % (7x1) Initial state vector

    % Matriz U (control inputs)
    U = [Ur; Rr; velBody(1); velBody(3)];  % (4x1) Control input vector

    % Producto de estados
    Y = C * X + D * U;  % (2x1) Output vector
    X = A * X + B * U;  % (7x1) Updated state vector

    % Salida del controlador
    M_i = double(Y(1) + Y(2));
    M_d = double(Y(1) - Y(2));

end